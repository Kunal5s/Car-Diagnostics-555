
# Car Diagnostics AI

This is a Next.js application built in Firebase Studio. It uses a powerful AI system to generate fresh, in-depth articles on automotive topics daily, with a smart caching system powered by Supabase to ensure reliability and performance.

## Getting Started

This project requires one environment variable to be set up on your hosting platform (e.g., Vercel) for the AI features to work.

### Required Environment Variables

-   `GOOGLE_API_KEY`: Your API key for the Google Gemini model. You can get this from [Google AI Studio](https://aistudio.google.com/app/apikey).

Create a `.env.local` file in the root of your project for local development:
```
GOOGLE_API_KEY="your_google_api_key_here"
```

The Supabase connection details have been configured directly in the code. You just need to set up the table as described below.

### Supabase Setup

You need to create a table in your Supabase project and set the correct permissions for the article caching to work.

#### 1. Create the `articles` Table

1.  Go to your Supabase project dashboard.
2.  In the left menu, navigate to the **SQL Editor**.
3.  Click **+ New query** and paste the following SQL script:
    ```sql
    -- Create the table for caching articles
    CREATE TABLE articles (
        id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
        slug TEXT UNIQUE NOT NULL,
        title TEXT NOT NULL,
        category TEXT NOT NULL,
        summary TEXT,
        content TEXT,
        generated_at TIMESTAMPTZ DEFAULT NOW()
    );
    ```
4.  Click **Run**.

#### 2. Create Access Policies

By default, new tables are protected by Row Level Security (RLS). You need to create "policies" to allow the website to read from and write to the `articles` table.

1.  In the SQL Editor, create another **+ New query**.
2.  Paste and **Run** the following SQL script. This will create the three required policies for reading, inserting, and updating articles.

    ```sql
    -- 1. Enable Row Level Security on the table
    ALTER TABLE public.articles ENABLE ROW LEVEL SECURITY;

    -- 2. Create a policy to allow public read access
    CREATE POLICY "Allow public read access" ON public.articles
    FOR SELECT USING (true);

    -- 3. Create a policy to allow public insert access
    CREATE POLICY "Allow public insert access" ON public.articles
    FOR INSERT WITH CHECK (true);

    -- 4. Create a policy to allow public update access
    CREATE POLICY "Allow public update access" ON public.articles
    FOR UPDATE USING (true);
    ```

After running these scripts, your database will be correctly configured to work with the application.

## Content Strategy: The Best of Both Worlds

This application uses a hybrid content strategy to provide fresh daily content while ensuring maximum reliability and performance.

-   **Dynamic AI Generation:** When a user visits an article page for the first time on any given day, the content is generated in real-time by the powerful Gemini 1.5 Pro AI model. This ensures the content is always fresh, unique, and in-depth.
-   **Supabase Smart Caching:** Once an article is generated, it is automatically saved (cached) in your Supabase database for 24 hours. Any other user who visits that same article on the same day will be served the content instantly from the Supabase cache, not from the AI.
-   **Reliability & Performance:** This "generate-once, serve-many" approach dramatically reduces API calls, lowers costs, and ensures the site is fast and reliable, avoiding the errors and timeouts common with live AI generation on every page load.
-   **Static Topic Base:** The site is built on a stable foundation of 54 curated article topics. This ensures that all category pages and article URLs are permanent and SEO-friendly.
-   **Daily Homepage Refresh:** To keep the experience fresh, the homepage automatically shuffles the article topics every 24 hours to feature a new set of 6 "trending" articles.

This hybrid model provides the dynamic, AI-powered content you want with the stability and performance that a professional website requires.
