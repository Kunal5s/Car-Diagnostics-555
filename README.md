
# Car Diagnostics AI

This is a Next.js application built in Firebase Studio. It uses a powerful AI system to generate fresh, in-depth articles on automotive topics daily, with a smart caching system powered by Supabase to ensure reliability and performance.

## Getting Started

This project requires **two environment variables** to be set up for the AI features to work, and a **one-time database setup** on Supabase.

### 1. Required Environment Variables

You need to set up these two secrets on your hosting platform (e.g., Vercel, Firebase App Hosting). For local development, create a `.env` file in the root of your project.

-   `GOOGLE_API_KEY`: Your API key for the Google Gemini model. You can get this from [Google AI Studio](https://aistudio.google.com/app/apikey).
-   `UNSPLASH_API_KEY`: Your API key for the Unsplash API, used to fetch article images. You can get this by creating a free developer account on the [Unsplash Developers](https://unsplash.com/developers) page.

Your local `.env` file should look like this:
```
GOOGLE_API_KEY="your_google_api_key_here"
UNSPLASH_API_KEY="your_unsplash_api_key_here"
```

The Supabase connection details have been configured directly in the code, so you do not need to set them as environment variables.

### 2. Supabase Database Setup

**This step is mandatory.** The application uses Supabase as a cache to store generated articles, which makes the site fast and reliable. You need to create a table in your Supabase project and set the correct access policies.

1.  Go to your Supabase project dashboard.
2.  In the left menu, navigate to the **SQL Editor**.
3.  Click **+ New query**.
4.  Copy the entire SQL script below and paste it into the query editor.
5.  Click **Run**.

```sql
-- Create the table for caching articles
CREATE TABLE articles (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    slug TEXT UNIQUE NOT NULL,
    title TEXT NOT NULL,
    category TEXT NOT NULL,
    summary TEXT,
    content TEXT,
    image_url TEXT,
    generated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable Row Level Security on the table
ALTER TABLE public.articles ENABLE ROW LEVEL SECURITY;

-- Create a policy to allow public read access
-- This allows anyone to read the articles from the cache.
CREATE POLICY "Allow public read access" ON public.articles
FOR SELECT USING (true);

-- Create a policy to allow public insert access
-- This allows the app to save new articles to the cache.
CREATE POLICY "Allow public insert access" ON public.articles
FOR INSERT WITH CHECK (true);

-- Create a policy to allow public update access
-- This allows the app to update existing articles in the cache.
CREATE POLICY "Allow public update access" ON public.articles
FOR UPDATE USING (true);
```

> **IMPORTANT:** If you do not perform this database setup step correctly, the website will show a "Database Configuration Error" on the article pages. The SQL script above creates the table and all the necessary permissions at once.

After running this script, your database will be correctly configured to work with the application.

## Content Strategy: The Best of Both Worlds

This application uses a hybrid content strategy to provide fresh daily content while ensuring maximum reliability and performance.

-   **Dynamic AI Generation:** When a user visits an article page for the first time on any given day, the content is generated in real-time by the powerful Gemini 1.5 Pro AI model.
-   **Dynamic Image Fetching:** At the same time, an image relevant to the article's topic is fetched from the Unsplash API.
-   **Supabase Smart Caching:** Once an article and its image are generated/fetched, they are automatically saved (cached) in your Supabase database for 24 hours. Any other user who visits that same article on the same day will be served the content instantly from the Supabase cache, not from the AI.
-   **Reliability & Performance:** This "generate-once, serve-many" approach dramatically reduces API calls, lowers costs, and ensures the site is fast and reliable, avoiding the errors and timeouts common with live AI generation on every page load.
-   **Static Topic Base:** The site is built on a stable foundation of 54 curated article topics. This ensures that all category pages and article URLs are permanent and SEO-friendly.
-   **Daily Homepage Refresh:** To keep the experience fresh, the homepage automatically shuffles the article topics every 24 hours to feature a new set of 6 "trending" articles.

This hybrid model provides the dynamic, AI-powered content you want with the stability and performance that a professional website requires.
