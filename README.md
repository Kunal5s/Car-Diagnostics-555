
# Car Diagnostics AI

This is a Next.js application built in Firebase Studio. It uses a powerful AI system and a smart caching database (Supabase) to generate and serve a complete library of in-depth automotive articles. This provides the perfect balance of fresh, AI-powered content and a fast, reliable user experience.

## Getting Started

This project requires **one environment variable** and a **one-time database setup** for all features to work correctly.

### 1. Required Environment Variable

For the website to generate its content, you **must** create a `.env` file in the project's root directory and add your OpenRouter API key.

The file content should look like this:
```
OPENROUTER_API_KEY="your_openrouter_api_key_here"
```

1.  **`OPENROUTER_API_KEY`**: Your API key for the OpenRouter service, which is used to generate article content with the LLaMA 3 model. You can get a free key from the [OpenRouter website](https://openrouter.ai/).

> **IMPORTANT:** Without this key in a `.env` file (for local development) or set as an environment variable in your hosting provider (for production), the article generation will fail.

### 2. Supabase Database Setup (Mandatory)

This application uses Supabase as a smart cache to store generated articles. This is critical for performance and reliability. You must create a table in your Supabase project.

1.  Go to your Supabase project dashboard.
2.  In the left menu, navigate to the **SQL Editor**.
3.  Click **+ New query**.
4.  Copy the entire SQL script below and paste it into the query editor.
5.  Click **Run**.

```sql
-- This script sets up your database for the project.
-- It will delete any existing 'articles' table to ensure a clean setup.
DROP TABLE IF EXISTS public.articles;

-- Create the table for caching articles
CREATE TABLE public.articles (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    slug TEXT UNIQUE NOT NULL,
    title TEXT NOT NULL,
    category TEXT NOT NULL,
    summary TEXT,
    content TEXT,
    image_url TEXT,
    generated_at TIMESTAMPTZ DEFAULT NOW() NOT NULL
);

-- Add comments to the columns for clarity in the Supabase UI
COMMENT ON TABLE public.articles IS 'Cache for AI-generated articles to improve performance and reliability.';
COMMENT ON COLUMN public.articles.slug IS 'The unique URL-friendly identifier for the article.';
COMMENT ON COLUMN public.articles.generated_at IS 'The timestamp when the article was last generated and cached.';


-- Enable Row Level Security on the table
ALTER TABLE public.articles ENABLE ROW LEVEL SECURITY;

-- Create a policy to allow public read access
-- This allows anyone to read the articles from the cache.
CREATE POLICY "Allow public read access" ON public.articles
FOR SELECT USING (true);

-- Create a policy to allow anyone to insert/update articles.
-- In a real-world secure application, you would restrict this to a service role key.
-- For this project's architecture, allowing public upsert is safe.
CREATE POLICY "Allow public insert and update access" ON public.articles
FOR ALL USING (true) WITH CHECK (true);

```

> **IMPORTANT:** If you do not perform this database setup, the website will show a "Database Configuration Error" on the article pages. The application's Supabase URL and public key are already configured in the code.

## Content Strategy: The Best of Both Worlds

This application uses a hybrid content strategy that provides fresh daily content while ensuring maximum reliability and performance.

-   **Dynamic AI Generation:** When a user visits an article page for the first time on any given day, the content is generated in real-time by the powerful `meta-llama/llama-3-70b-instruct` model via OpenRouter.
-   **Supabase Smart Caching:** Once an article is generated, it is automatically saved (cached) in your Supabase database for 24 hours. Any other user who visits that same article on the same day will be served the content instantly from the Supabase cache, not from the AI.
-   **Reliability & Performance:** This "generate-once, serve-many" approach dramatically reduces API calls, lowers costs, and ensures the site is fast and reliable, avoiding the errors and timeouts common with live AI generation on every page load.
-   **Static Topic Base:** The site is built on a stable foundation of 60 curated article topics. This ensures that all category pages and article URLs are permanent and SEO-friendly.
-   **Daily Homepage Refresh:** To keep the experience fresh, the homepage automatically shuffles the article topics every 24 hours to feature a new set of 6 "trending" articles.
